<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

    :root {
      --text-primary: #111827;
      --text-secondary: #4B5563;
      --border: #E5E7EB;

      --danger: #D92D20;
      --success: #079455;

      --radius-card: 24px;
      --radius-control: 8px;

      --shadow-card: 0px 4px 6px -2px #10182808, 0px 12px 16px -4px #10182814;
      --focus: 0 0 0 4px rgba(22, 70, 206, 0.18);

      /* 4px scale */
      --space-8: 8px;
      --space-12: 12px;
      --space-16: 16px;
      --space-20: 20px;
      --space-24: 24px;
      --space-28: 28px;
      --space-32: 32px;
    }

    * { box-sizing: border-box; }

    body {
      font-family: "Inter Display", Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: 16px;
      line-height: 1.5;
      margin: 0;
      padding: 24px;
      color: var(--text-primary);
      background: var(--background);
    }

    /* Webflow-style layout primitives (kept small on purpose) */
    .page-wrapper { min-height: 100%; padding: var(--space-32) var(--space-20); }
    .container { max-width: 1040px; margin: 0 auto; }
    .section { padding: 0; }

    .grid-2col {
      display: grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap: var(--space-20);
      align-items: start;
    }

    @media (max-width: 991px) {
      .page-wrapper { padding: var(--space-24) var(--space-16); }
      .grid-2col { grid-template-columns: 1fr; }
    }

    .card {
      border: 1px solid var(--border);
      border-radius: var(--radius-card);
      padding: var(--space-24);
      box-shadow: var(--shadow-card);
      background: #fff;
    }

    .stack { display: flex; flex-direction: column; gap: var(--space-16); }
    .stack-lg { gap: var(--space-24); }
    .row { display: flex; gap: var(--space-12); align-items: center; flex-wrap: wrap; }
    .row-between { justify-content: space-between; }

    .heading-xl { font-size: 28px; line-height: 1.2; margin: 0; letter-spacing: -0.02em; }
    .heading-md { font-size: 18px; line-height: 1.3; margin: 0; letter-spacing: -0.01em; }
    .text-muted { color: var(--text-secondary); margin: 0; }
    .text-sm { font-size: 13px; line-height: 1.5; }

    .form-field { display: grid; gap: var(--space-8); }
    .label { font-size: 13px; font-weight: 500; color: var(--text-primary); }

    .input, .select {
      width: 100%;
      border: 1px solid var(--border);
      border-radius: var(--radius-control);
      height: 56px;
      padding: 0 var(--space-16);
      font-size: 16px;
      outline: none;
      background: #fff;
      color: var(--text-primary);
      transition: box-shadow 160ms ease, border-color 160ms ease, transform 160ms ease;
    }

    .input:focus, .select:focus { box-shadow: var(--focus); border-color: rgba(22, 70, 206, 0.35); }

    .help, .error {
      font-size: 13px;
      margin: 0;
    }

    .help { color: var(--text-secondary); }
    .error { color: var(--danger); display: none; }
    .field-invalid .input, .field-invalid .select { border-color: rgba(217, 45, 32, 0.45); }
    .field-invalid .error { display: block; }

    .segmented {
      display: inline-flex;
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 4px;
      background: rgba(17, 24, 39, 0.03);
      gap: 4px;
    }

    .segmented-button {
      border: 0;
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 13px;
      background: transparent;
      color: var(--text-secondary);
      cursor: pointer;
      transition: background 160ms ease, color 160ms ease, transform 160ms ease;
    }

    .segmented-button[aria-pressed="true"] {
      background: #fff;
      color: var(--text-primary);
      box-shadow: 0 8px 18px rgba(17, 24, 39, 0.08);
    }

    .button {
      width: 100%;
      height: 56px;
      border: 0;
      background: linear-gradient(to bottom, #3D65D6 0%, #1646CE 100%);
      color: #fff;
      font-size: 16px;
      font-weight: 500;
      border-radius: var(--radius-control);
      padding: 0 var(--space-16);
      cursor: pointer;
      transition: transform 120ms ease, opacity 120ms ease;
      box-shadow: none;
    }

    .button:active { transform: translateY(0px); }
    .button:disabled { cursor: not-allowed; transform: none; }

    /* Results: hidden until valid input + smooth reveal */
    .results {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transform: translateY(8px);
      transition: max-height 360ms ease, opacity 240ms ease, transform 240ms ease;
      will-change: max-height, opacity, transform;
      pointer-events: none;
    }

    .results.is-visible {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .results-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-12);
      margin-top: var(--space-12);
    }

    .metric {
      border: 1px solid var(--border);
      border-radius: var(--radius-control);
      padding: var(--space-16);
      background: rgba(17, 24, 39, 0.02);
    }

    .metric-spaced { margin-top: var(--space-12); }

    .metric .k { font-size: 13px; color: var(--text-secondary); margin: 0 0 6px; }
    .metric .v { font-size: 20px; font-weight: 600; margin: 0; letter-spacing: -0.01em; }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: var(--space-8);
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(17, 24, 39, 0.02);
      font-size: 12px;
      color: var(--text-secondary);
      white-space: nowrap;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--success);
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <div class="container section">
      <div class="stack stack-lg">
        <div class="grid-2col">
          <!-- Calculator -->
          <div class="card">
            <div class="stack">
              <div class="row row-between">
                <h2 class="heading-md">Your details</h2>
                <div class="segmented" role="group" aria-label="Income frequency">
                  <button class="segmented-button" type="button" id="freqMonthly" aria-pressed="false">Monthly</button>
                  <button class="segmented-button" type="button" id="freqAnnual" aria-pressed="true">Annual</button>
                </div>
              </div>

              <div class="form-field" id="countryField">
                <label class="label" for="country">Country</label>
                <select class="select" id="country" name="country" required>
                  <option value="">Select a country</option>
                </select>
                <p class="error" id="countryError">Please select a country.</p>
              </div>

              <div class="form-field" id="incomeField">
                <label class="label" for="income">Income</label>
                <input class="input" id="income" name="income" inputmode="decimal" autocomplete="off" placeholder="e.g. 120000" />
                <p class="help" id="incomeHelp">Enter your gross income (<span id="freqLabel">annual</span>).</p>
                <p class="error" id="incomeError">Enter a valid income greater than 0.</p>
              </div>

              <button class="button" id="calculate" type="button" disabled>Calculate Tax</button>
            </div>
          </div>

          <!-- Results -->
          <div class="card" aria-live="polite">
            <div class="row row-between">
              <h2 class="heading-md">Results</h2>
              <div class="badge" id="rateBadge" style="display:none;">
                <span class="dot" aria-hidden="true"></span>
                <span><span id="countryName">—</span> rate: <strong id="rateValue">—</strong></span>
              </div>
            </div>

            <div class="results" id="results" aria-hidden="true" style="max-height:0px;">
              <div class="results-grid">
                <div class="metric">
                  <p class="k">Monthly tax</p>
                  <p class="v" id="monthlyTax">—</p>
                </div>
                <div class="metric">
                  <p class="k">Annual tax</p>
                  <p class="v" id="annualTax">—</p>
                </div>
                <div class="metric">
                  <p class="k">Monthly net</p>
                  <p class="v" id="monthlyNet">—</p>
                </div>
                <div class="metric">
                  <p class="k">Annual net</p>
                  <p class="v" id="annualNet">—</p>
                </div>
              </div>

              <div class="metric metric-spaced">
                <p class="k">Effective tax rate</p>
                <p class="v" id="effectiveRate">—</p>
              </div>
            </div>

            <div class="text-muted text-sm" id="resultsHint">Fill in the form to see your results.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /**
     * Sample flat-rate config (replace with your real rules).
     * Rates are expressed as decimals (e.g. 0.30 = 30%).
     */
    const TAX_CONFIG = {
      // NOTE: Config shape intentionally matches the existing calculator logic:
      // - label: used for dropdown + results badge
      // - rate: flat tax rate (decimal)
      // - currency: kept as USD so display uses "$" for every country

      // North America
      US: { rate: 0.25, label: "United States", currency: "USD" },
      CA: { rate: 0.26, label: "Canada", currency: "USD" },
      MX: { rate: 0.30, label: "Mexico", currency: "USD" },

      // South America
      AR: { rate: 0.35, label: "Argentina", currency: "USD" },
      BR: { rate: 0.27, label: "Brazil", currency: "USD" },
      CL: { rate: 0.35, label: "Chile", currency: "USD" },
      CO: { rate: 0.33, label: "Colombia", currency: "USD" },
      PE: { rate: 0.29, label: "Peru", currency: "USD" },
      VE: { rate: 0.34, label: "Venezuela", currency: "USD" },
      EC: { rate: 0.35, label: "Ecuador", currency: "USD" },
      BO: { rate: 0.25, label: "Bolivia", currency: "USD" },
      PY: { rate: 0.10, label: "Paraguay", currency: "USD" },
      UY: { rate: 0.25, label: "Uruguay", currency: "USD" },

      // Europe - Western
      UK: { rate: 0.20, label: "United Kingdom", currency: "USD" },
      DE: { rate: 0.42, label: "Germany", currency: "USD" },
      FR: { rate: 0.45, label: "France", currency: "USD" },
      IT: { rate: 0.43, label: "Italy", currency: "USD" },
      ES: { rate: 0.24, label: "Spain", currency: "USD" },
      NL: { rate: 0.37, label: "Netherlands", currency: "USD" },
      BE: { rate: 0.50, label: "Belgium", currency: "USD" },
      AT: { rate: 0.50, label: "Austria", currency: "USD" },
      CH: { rate: 0.21, label: "Switzerland", currency: "USD" },
      PT: { rate: 0.28, label: "Portugal", currency: "USD" },
      IE: { rate: 0.20, label: "Ireland", currency: "USD" },
      LU: { rate: 0.42, label: "Luxembourg", currency: "USD" },

      // Europe - Northern
      SE: { rate: 0.52, label: "Sweden", currency: "USD" },
      NO: { rate: 0.38, label: "Norway", currency: "USD" },
      DK: { rate: 0.55, label: "Denmark", currency: "USD" },
      FI: { rate: 0.51, label: "Finland", currency: "USD" },
      IS: { rate: 0.46, label: "Iceland", currency: "USD" },

      // Europe - Eastern
      PL: { rate: 0.32, label: "Poland", currency: "USD" },
      CZ: { rate: 0.23, label: "Czech Republic", currency: "USD" },
      HU: { rate: 0.15, label: "Hungary", currency: "USD" },
      RO: { rate: 0.10, label: "Romania", currency: "USD" },
      BG: { rate: 0.10, label: "Bulgaria", currency: "USD" },
      SK: { rate: 0.25, label: "Slovakia", currency: "USD" },
      HR: { rate: 0.30, label: "Croatia", currency: "USD" },
      SI: { rate: 0.50, label: "Slovenia", currency: "USD" },
      LT: { rate: 0.32, label: "Lithuania", currency: "USD" },
      LV: { rate: 0.31, label: "Latvia", currency: "USD" },
      EE: { rate: 0.20, label: "Estonia", currency: "USD" },
      RS: { rate: 0.20, label: "Serbia", currency: "USD" },
      UA: { rate: 0.18, label: "Ukraine", currency: "USD" },

      // Europe - Southern
      GR: { rate: 0.44, label: "Greece", currency: "USD" },
      CY: { rate: 0.35, label: "Cyprus", currency: "USD" },
      MT: { rate: 0.35, label: "Malta", currency: "USD" },

      // Middle East
      AE: { rate: 0.00, label: "United Arab Emirates", currency: "USD" },
      SA: { rate: 0.00, label: "Saudi Arabia", currency: "USD" },
      IL: { rate: 0.50, label: "Israel", currency: "USD" },
      TR: { rate: 0.35, label: "Turkey", currency: "USD" },
      JO: { rate: 0.20, label: "Jordan", currency: "USD" },
      LB: { rate: 0.15, label: "Lebanon", currency: "USD" },
      KW: { rate: 0.00, label: "Kuwait", currency: "USD" },
      QA: { rate: 0.00, label: "Qatar", currency: "USD" },
      OM: { rate: 0.00, label: "Oman", currency: "USD" },
      BH: { rate: 0.00, label: "Bahrain", currency: "USD" },

      // Asia - East
      CN: { rate: 0.35, label: "China", currency: "USD" },
      JP: { rate: 0.45, label: "Japan", currency: "USD" },
      KR: { rate: 0.38, label: "South Korea", currency: "USD" },
      TW: { rate: 0.40, label: "Taiwan", currency: "USD" },
      HK: { rate: 0.15, label: "Hong Kong", currency: "USD" },
      MO: { rate: 0.12, label: "Macau", currency: "USD" },

      // Asia - Southeast
      SG: { rate: 0.17, label: "Singapore", currency: "USD" },
      MY: { rate: 0.28, label: "Malaysia", currency: "USD" },
      TH: { rate: 0.35, label: "Thailand", currency: "USD" },
      ID: { rate: 0.30, label: "Indonesia", currency: "USD" },
      PH: { rate: 0.32, label: "Philippines", currency: "USD" },
      VN: { rate: 0.35, label: "Vietnam", currency: "USD" },
      MM: { rate: 0.25, label: "Myanmar", currency: "USD" },
      KH: { rate: 0.20, label: "Cambodia", currency: "USD" },
      LA: { rate: 0.24, label: "Laos", currency: "USD" },
      BN: { rate: 0.00, label: "Brunei", currency: "USD" },

      // Asia - South
      IN: { rate: 0.30, label: "India", currency: "USD" },
      PK: { rate: 0.29, label: "Pakistan", currency: "USD" },
      BD: { rate: 0.30, label: "Bangladesh", currency: "USD" },
      LK: { rate: 0.24, label: "Sri Lanka", currency: "USD" },
      NP: { rate: 0.30, label: "Nepal", currency: "USD" },

      // Oceania
      AU: { rate: 0.30, label: "Australia", currency: "USD" },
      NZ: { rate: 0.33, label: "New Zealand", currency: "USD" },
      FJ: { rate: 0.20, label: "Fiji", currency: "USD" },
      PG: { rate: 0.30, label: "Papua New Guinea", currency: "USD" },

      // Africa - North
      EG: { rate: 0.25, label: "Egypt", currency: "USD" },
      DZ: { rate: 0.35, label: "Algeria", currency: "USD" },
      MA: { rate: 0.38, label: "Morocco", currency: "USD" },
      TN: { rate: 0.35, label: "Tunisia", currency: "USD" },
      LY: { rate: 0.10, label: "Libya", currency: "USD" },

      // Africa - West
      NG: { rate: 0.24, label: "Nigeria", currency: "USD" },
      GH: { rate: 0.25, label: "Ghana", currency: "USD" },
      CI: { rate: 0.25, label: "Côte d'Ivoire", currency: "USD" },
      SN: { rate: 0.40, label: "Senegal", currency: "USD" },

      // Africa - East
      KE: { rate: 0.30, label: "Kenya", currency: "USD" },
      TZ: { rate: 0.30, label: "Tanzania", currency: "USD" },
      UG: { rate: 0.30, label: "Uganda", currency: "USD" },
      ET: { rate: 0.35, label: "Ethiopia", currency: "USD" },
      RW: { rate: 0.30, label: "Rwanda", currency: "USD" },

      // Africa - South
      ZA: { rate: 0.45, label: "South Africa", currency: "USD" },
      ZW: { rate: 0.25, label: "Zimbabwe", currency: "USD" },
      BW: { rate: 0.25, label: "Botswana", currency: "USD" },
      NA: { rate: 0.37, label: "Namibia", currency: "USD" },
      MU: { rate: 0.15, label: "Mauritius", currency: "USD" },

      // Caribbean
      JM: { rate: 0.25, label: "Jamaica", currency: "USD" },
      TT: { rate: 0.30, label: "Trinidad and Tobago", currency: "USD" },
      BB: { rate: 0.25, label: "Barbados", currency: "USD" },
      BS: { rate: 0.00, label: "Bahamas", currency: "USD" },

      // Central America
      CR: { rate: 0.30, label: "Costa Rica", currency: "USD" },
      PA: { rate: 0.25, label: "Panama", currency: "USD" },
      GT: { rate: 0.25, label: "Guatemala", currency: "USD" },
      SV: { rate: 0.30, label: "El Salvador", currency: "USD" },
      HN: { rate: 0.25, label: "Honduras", currency: "USD" },
      NI: { rate: 0.30, label: "Nicaragua", currency: "USD" },

      // Central Asia
      KZ: { rate: 0.10, label: "Kazakhstan", currency: "USD" },
      UZ: { rate: 0.12, label: "Uzbekistan", currency: "USD" },

      // Other
      RU: { rate: 0.13, label: "Russia", currency: "USD" },
      BY: { rate: 0.13, label: "Belarus", currency: "USD" },
    };

    const els = {
      country: document.getElementById("country"),
      income: document.getElementById("income"),
      calculate: document.getElementById("calculate"),
      freqMonthly: document.getElementById("freqMonthly"),
      freqAnnual: document.getElementById("freqAnnual"),
      freqLabel: document.getElementById("freqLabel"),

      countryField: document.getElementById("countryField"),
      incomeField: document.getElementById("incomeField"),
      countryError: document.getElementById("countryError"),
      incomeError: document.getElementById("incomeError"),

      results: document.getElementById("results"),
      resultsHint: document.getElementById("resultsHint"),
      rateBadge: document.getElementById("rateBadge"),
      countryName: document.getElementById("countryName"),
      rateValue: document.getElementById("rateValue"),
      monthlyTax: document.getElementById("monthlyTax"),
      annualTax: document.getElementById("annualTax"),
      monthlyNet: document.getElementById("monthlyNet"),
      annualNet: document.getElementById("annualNet"),
      effectiveRate: document.getElementById("effectiveRate"),
    };

    let incomeFrequency = "annual"; // "monthly" | "annual"
    let hasCalculated = false;

    function formatMoney(value, currency) {
      try {
        return new Intl.NumberFormat(undefined, {
          style: "currency",
          currency,
          maximumFractionDigits: 0,
        }).format(value);
      } catch {
        return `${currency} ${Math.round(value).toLocaleString()}`;
      }
    }

    function parseIncome(raw) {
      const cleaned = String(raw ?? "").trim().replace(/[, ]+/g, "");
      if (!cleaned) return NaN;
      const n = Number(cleaned);
      return Number.isFinite(n) ? n : NaN;
    }

    function setFrequency(next) {
      incomeFrequency = next;
      const isMonthly = incomeFrequency === "monthly";
      els.freqMonthly.setAttribute("aria-pressed", String(isMonthly));
      els.freqAnnual.setAttribute("aria-pressed", String(!isMonthly));
      els.freqLabel.textContent = isMonthly ? "monthly" : "annual";
      hasCalculated = false;
      hideResults();
      validateAndMaybeCalculate({ shouldCalculate: false });
    }

    function showResults() {
      els.results.setAttribute("aria-hidden", "false");
      els.resultsHint.style.display = "none";
      els.results.classList.add("is-visible");
      // Expand (no scrolling): animate to actual content height.
      requestAnimationFrame(() => {
        els.results.style.maxHeight = `${els.results.scrollHeight}px`;
      });
    }

    function hideResults() {
      // Animate collapse (no scrolling): set current height -> 0.
      els.results.style.maxHeight = `${els.results.scrollHeight}px`;
      void els.results.offsetHeight;
      els.results.classList.remove("is-visible");
      els.results.style.maxHeight = "0px";
      els.results.setAttribute("aria-hidden", "true");
      els.rateBadge.style.display = "none";
      els.resultsHint.style.display = "";
    }

    function setFieldValidity(fieldEl, isValid) {
      fieldEl.classList.toggle("field-invalid", !isValid);
    }

    function validate() {
      const countryCode = els.country.value;
      const income = parseIncome(els.income.value);

      const countryValid = Boolean(countryCode && TAX_CONFIG[countryCode]);
      const incomeValid = Number.isFinite(income) && income > 0;

      setFieldValidity(els.countryField, countryValid);
      setFieldValidity(els.incomeField, incomeValid);

      const allValid = countryValid && incomeValid;
      els.calculate.disabled = !allValid;

      return { allValid, countryCode, income };
    }

    function calculate({ countryCode, income }) {
      const config = TAX_CONFIG[countryCode];
      const annualIncome = incomeFrequency === "monthly" ? income * 12 : income;
      const monthlyIncome = annualIncome / 12;

      const annualTax = annualIncome * config.rate;
      const monthlyTax = annualTax / 12;

      const annualNet = annualIncome - annualTax;
      const monthlyNet = annualNet / 12;

      const effRate = annualIncome > 0 ? (annualTax / annualIncome) : 0;

      els.countryName.textContent = config.label;
      els.rateValue.textContent = `${Math.round(config.rate * 1000) / 10}%`;
      els.rateBadge.style.display = "";

      els.monthlyTax.textContent = formatMoney(monthlyTax, config.currency);
      els.annualTax.textContent = formatMoney(annualTax, config.currency);
      els.monthlyNet.textContent = formatMoney(monthlyNet, config.currency);
      els.annualNet.textContent = formatMoney(annualNet, config.currency);
      els.effectiveRate.textContent = `${Math.round(effRate * 1000) / 10}%`;

      // Also keep calculations consistent in case of rounding display:
      // monthlyIncome is unused currently but useful if you extend UI later.
      void monthlyIncome;
    }

    function validateAndMaybeCalculate({ shouldCalculate }) {
      const v = validate();
      if (!v.allValid) {
        hasCalculated = false;
        hideResults();
        return;
      }

      // If user edits inputs after calculating, keep results hidden until they re-calculate.
      if (!shouldCalculate && hasCalculated) {
        hasCalculated = false;
        hideResults();
        return;
      }

      if (shouldCalculate) {
        hasCalculated = true;
        calculate(v);
        showResults();
      }
    }

    function populateCountries() {
      const entries = Object.entries(TAX_CONFIG)
        .sort((a, b) => a[1].label.localeCompare(b[1].label));

      for (const [code, info] of entries) {
        const opt = document.createElement("option");
        opt.value = code;
        opt.textContent = info.label;
        els.country.appendChild(opt);
      }
    }

    // Wire up
    populateCountries();
    setFrequency("annual");

    els.freqMonthly.addEventListener("click", () => setFrequency("monthly"));
    els.freqAnnual.addEventListener("click", () => setFrequency("annual"));

    els.country.addEventListener("change", () => validateAndMaybeCalculate({ shouldCalculate: false }));
    els.income.addEventListener("input", () => validateAndMaybeCalculate({ shouldCalculate: false }));

    els.calculate.addEventListener("click", () => validateAndMaybeCalculate({ shouldCalculate: true }));

    // Press Enter to calculate from income field
    els.income.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        validateAndMaybeCalculate({ shouldCalculate: true });
      }
    });

    // Keep expanded height correct on responsive reflow.
    window.addEventListener("resize", () => {
      if (els.results.classList.contains("is-visible")) {
        els.results.style.maxHeight = `${els.results.scrollHeight}px`;
      }
    });
  </script>

</body>
</html>
